import{r,j as e,A as b,u as k,L as N}from"./index-DISiB1UJ.js";const v=({closePopup:s})=>{const[c,t]=r.useState(""),[d,o]=r.useState(""),[l,u]=r.useState(!1),n=async()=>{var i,m;if(!c){o("× × ×œ×”×–×™×Ÿ ×›×ª×•×‘×ª ××™×ž×™×™×œ");return}u(!0),o("");try{const a=await b.post("/auth/forgot-password",{email:c});o("âœ… ×§×™×©×•×¨ ××™×¤×•×¡ × ×©×œ×— ×œ××™×ž×™×™×œ ×©×œ×š!")}catch(a){console.error("âŒ ×©×’×™××” ×‘×©×œ×™×—×ª ×§×•×“ ××™×¤×•×¡:",a),o(((m=(i=a.response)==null?void 0:i.data)==null?void 0:m.error)||"âŒ ×©×’×™××” ×‘×œ×ª×™ ×¦×¤×•×™×”. × ×¡×” ×©×•×‘.")}finally{u(!1)}};return e.jsx("div",{className:"forgot-password-overlay",children:e.jsxs("div",{className:"forgot-password-modal",children:[e.jsx("h2",{children:"×©×—×–×•×¨ ×¡×™×¡×ž×”"}),e.jsx("p",{children:"×”×–×Ÿ ××ª ×›×ª×•×‘×ª ×”××™×ž×™×™×œ ×©×œ×š ×•× ×©×œ×— ×œ×š ×§×™×©×•×¨ ×œ××™×¤×•×¡ ×”×¡×™×¡×ž×”"}),e.jsx("input",{type:"email",placeholder:"×”×–×Ÿ ××™×ž×™×™×œ",value:c,onChange:i=>t(i.target.value)}),e.jsx("button",{onClick:n,className:"send-button",disabled:l,children:l?"ðŸ”„ ×©×•×œ×—...":"×©×œ×— ×§×™×©×•×¨ ××™×¤×•×¡"}),d&&e.jsx("p",{className:"message",children:d}),e.jsx("button",{onClick:s,className:"close-button",children:"×¡×’×•×¨"})]})})},S=()=>{const[s,c]=r.useState({email:"",username:"",password:""}),[t,d]=r.useState(!1),[o,l]=r.useState(!1),[u,n]=r.useState(""),[i,m]=r.useState(!1),a=k(),g=h=>{c({...s,[h.target.name]:h.target.value})},w=async h=>{var f;if(h.preventDefault(),n(""),l(!0),!t&&(!s.email||!s.password)||t&&(!s.username||!s.password)){n("× × ×œ×ž×œ× ××ª ×›×œ ×”×©×“×•×ª"),l(!1);return}try{const x=t?{username:s.username,password:s.password}:{email:s.email,password:s.password},p=await b.post("/auth/login",x,{withCredentials:!0});p.data.token&&localStorage.setItem("token",p.data.token);const j=p.data.user;switch(localStorage.setItem("user",JSON.stringify(j)),j.role){case"business":a("/dashboard");break;case"customer":a("/client-dashboard");break;case"worker":a("/staff/dashboard");break;case"manager":a("/manager/dashboard");break;case"admin":a("/admin/dashboard");break;default:a("/")}}catch(x){const p=(f=x.response)==null?void 0:f.status;n(p===401?"âŒ ×©× ×ž×©×ª×ž×© ××• ×¡×™×¡×ž×” ×©×’×•×™×™×":"âŒ ×©×’×™××” ×‘×©×¨×ª, × ×¡×• ×©×•×‘ ×ž××•×—×¨ ×™×•×ª×¨")}finally{l(!1)}};return e.jsxs("div",{className:"login-container",children:[e.jsxs("div",{className:"login-box",children:[e.jsx("h2",{children:t?"×›× ×™×¡×ª ×¢×•×‘×“×™×":"×”×ª×—×‘×¨×•×ª"}),e.jsxs("form",{onSubmit:w,children:[t?e.jsx("input",{type:"text",name:"username",placeholder:"×©× ×ž×©×ª×ž×©",value:s.username,onChange:g,autoComplete:"username",required:!0}):e.jsx("input",{type:"email",name:"email",placeholder:"××™×ž×™×™×œ",value:s.email,onChange:g,autoComplete:"email",required:!0}),e.jsx("input",{type:"password",name:"password",placeholder:"×¡×™×¡×ž×”",value:s.password,onChange:g,autoComplete:"current-password",required:!0}),e.jsx("button",{type:"submit",className:"login-button",disabled:o,children:o?"ðŸ”„ ×ž×ª×—×‘×¨...":"×”×ª×—×‘×¨"})]}),u&&e.jsx("p",{className:"error-message",children:u}),e.jsxs("div",{className:"login-extra-options",children:[t?e.jsx("button",{className:"staff-login-link",onClick:()=>{d(!1),n("")},children:"ðŸ”™ ×—×–×¨×” ×œ×”×ª×—×‘×¨×•×ª ×¨×’×™×œ×”"}):e.jsx("button",{className:"staff-login-link",onClick:()=>{d(!0),n("")},children:"ðŸ‘¤ ×›× ×™×¡×ª ×¢×•×‘×“×™×"}),e.jsxs("div",{className:"bottom-links",children:[e.jsx("span",{className:"forgot-password",onClick:()=>m(!0),children:"×©×›×—×ª ××ª ×”×¡×™×¡×ž×”?"}),!t&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"separator",children:"|"}),e.jsx(N,{to:"/register",className:"register-link",children:"××™×Ÿ ×œ×š ×—×©×‘×•×Ÿ? ×”×™×¨×©× ×¢×›×©×™×•"})]})]})]})]}),i&&e.jsx(v,{closePopup:()=>m(!1)})]})};export{S as default};
