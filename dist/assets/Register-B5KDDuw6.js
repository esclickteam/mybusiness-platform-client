import{r as u,u as j,j as e,L as y,A as p}from"./index-DISiB1UJ.js";const b=()=>{const[s,m]=u.useState({name:"",email:"",password:"",confirmPassword:"",userType:"customer"}),[d,l]=u.useState(""),c=j(),t=r=>{m({...s,[r.target.name]:r.target.value})},h=async()=>{var r,i,n,a;if(s.password!==s.confirmPassword){l("⚠️ הסיסמאות לא תואמות");return}try{const o=await p.post("/auth/register",{name:s.name,email:s.email,password:s.password,userType:s.userType});console.log("🎉 נרשמת בהצלחה:",o.data),g(s.email,s.password)}catch(o){console.error("❌ שגיאה בהרשמה:",(r=o.response)==null?void 0:r.data),l(((n=(i=o.response)==null?void 0:i.data)==null?void 0:n.error)||(((a=o.response)==null?void 0:a.status)===400?"❌ אימייל כבר רשום במערכת":"❌ שגיאה בלתי צפויה. נסה שוב מאוחר יותר."))}},g=async(r,i)=>{var n;try{const a=await p.post("/auth/login",{email:r,password:i});switch(localStorage.setItem("user",JSON.stringify(a.data.user)),localStorage.setItem("token",a.data.token),a.data.user.role){case"business":c("/plans");break;case"customer":c("/client-dashboard");break;default:c("/")}}catch(a){console.error("❌ שגיאה בהתחברות:",(n=a.response)==null?void 0:n.data)}},x=r=>{r.preventDefault(),l(""),h()};return e.jsxs("div",{className:"register-container",children:[e.jsx("h2",{children:"הרשמה"}),e.jsx("p",{children:"בחר את סוג החשבון שלך והזן את הפרטים"}),e.jsxs("form",{onSubmit:x,children:[e.jsx("input",{type:"text",name:"name",placeholder:"שם מלא",value:s.name,onChange:t,required:!0}),e.jsx("input",{type:"email",name:"email",placeholder:"אימייל",value:s.email,onChange:t,required:!0}),e.jsx("input",{type:"password",name:"password",placeholder:"סיסמה",value:s.password,onChange:t,required:!0}),e.jsx("input",{type:"password",name:"confirmPassword",placeholder:"אימות סיסמה",value:s.confirmPassword,onChange:t,required:!0}),e.jsxs("div",{className:"radio-container",children:[e.jsxs("div",{className:"radio-option",children:[e.jsx("input",{type:"radio",id:"customer",name:"userType",value:"customer",checked:s.userType==="customer",onChange:t}),e.jsx("label",{htmlFor:"customer",children:"הרשמה כלקוח"})]}),e.jsxs("div",{className:"radio-option",children:[e.jsx("input",{type:"radio",id:"business",name:"userType",value:"business",checked:s.userType==="business",onChange:t}),e.jsx("label",{htmlFor:"business",children:"הרשמה כבעל עסק"})]})]}),e.jsx("button",{type:"submit",className:"register-button",children:"הירשם"}),d&&e.jsx("p",{className:"error-message",children:d})]}),e.jsxs("div",{className:"login-link",children:["כבר יש לך חשבון? ",e.jsx(y,{to:"/login",children:"התחבר עכשיו"})]})]})};export{b as default};
