/* src/components/ClientChatTab.css */

/* קונטיינר הצ'אט */
.chat-container.client {
  display: flex;
  flex-direction: column;
  width: 100%;
  height: 100%;
  background: #f6f1fb;
}

/* רשימת ההודעות */
.message-list {
  flex: 1;
  overflow-y: auto;
  display: flex;
  flex-direction: column;
  gap: 10px;
  padding: 22px 16px 10px;
  background: none;
}

/* אנימציית fadeIn */
@keyframes fadeIn {
  0% { opacity: 0; transform: translateY(30%); }
  100% { opacity: 1; transform: none; }
}

/* בועה כללית */
.message {
  max-width: 72%;
  padding: 11px 16px 8px 12px;
  border-radius: 18px;
  word-wrap: break-word;
  line-height: 1.44;
  font-size: 15px;
  box-shadow: 0 1px 2px rgba(123, 67, 189, 0.06);
  border: 1.2px solid #ede7f6;
  display: flex;
  flex-direction: column;
  animation: fadeIn 0.42s cubic-bezier(.77,0,.18,1) both;
}

/* יישור והפרדה של הודעות בצד הלקוח */

/* הודעת המשתמש (לקוח) – לימין */
.chat-container.client .message.mine {
  align-self: flex-end; /* לימין */
  margin-left: 32px;
  margin-right: 0;
  background: #dcf8c6;
  text-align: right;
  border-radius: 18px 18px 4px 18px;
}

/* הודעת העסק – לשמאל */
.chat-container.client .message.theirs {
  align-self: flex-start; /* לשמאל */
  margin-right: 32px;
  margin-left: 0;
  background: #fff;
  text-align: left;
  border-radius: 18px 18px 18px 4px;
}

/* זמן בתוך הבועה */
.message .time {
  font-size: 11px;
  color: #878787;
  margin-top: 4px;
  text-align: left;
  direction: ltr;
  opacity: 0.75;
  padding-left: 4px;
}

/* מטא־מידע בתוך הבועה */
.message .meta {
  display: flex;
  align-items: center;
  gap: 4px;
  justify-content: flex-end;
  margin-top: 2px;
}

/* סימון קריאה - נקראה */
.read-indicator {
  font-size: 14px;
  user-select: none;
  margin-left: 6px;
  align-self: center;
}

/* הודעות מערכת */
.system-message {
  background: #f1f1f6;
  color: #8b8b99;
  border-radius: 14px;
  font-size: 13px;
  padding: 7px 14px;
  align-self: center;
  margin: 10px 0;
}

/* אינדיקטור “הלקוח מקליד…” */
.typing-indicator {
  padding: 0 20px 10px;
  color: #7c43bd;
  font-size: 14px;
  font-style: italic;
  animation: typing-blink 1.2s infinite;
}

@keyframes typing-blink {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.48; }
}

/* הודעה ריקה */
.empty {
  color: #aaa;
  text-align: center;
  padding: 22px 0 0;
}

/* אינדיקטור טעינה */
.loading {
  text-align: center;
  color: #777;
  font-size: 14px;
  padding: 12px 0;
}

/* שורת הקלט */
.inputBar {
  display: flex;
  flex-direction: row;
  align-items: flex-end;
  gap: 8px;
  padding: 12px 12px 12px 10px;
  border-top: 1.5px solid #e1bee7;
  background: #faf7fd;
  min-height: 62px;
  flex-wrap: nowrap;
}

/* שדה הקלדה */
.inputBar textarea,
.inputField {
  flex: 1 1 auto;
  min-width: 0;
  padding: 10px 16px;
  font-size: 15px;
  border: 1.5px solid #c3a6fa;
  border-radius: 26px;
  background: #fff;
  outline: none;
  transition: border-color 0.2s;
  direction: rtl;
  text-align: right;
  resize: none;
  max-height: 120px;
  min-height: 38px;
  line-height: 1.3;
}

.inputBar textarea:focus,
.inputField:focus {
  border-color: #7c43bd;
  background: #f6edff;
}

/* גל הקלטה אנימציה */
.waveform {
  display: flex;
  align-items: center;
  gap: 4px;
}
.wave-dot {
  width: 4px;
  height: 16px;
  background: #34b7f1;
  animation: wave 1s infinite ease-in-out;
}
.wave-dot:nth-child(2) { animation-delay: 0.1s; }
.wave-dot:nth-child(3) { animation-delay: 0.2s; }
.wave-dot:nth-child(4) { animation-delay: 0.3s; }
.wave-dot:nth-child(5) { animation-delay: 0.4s; }
@keyframes wave {
  0%, 100% { transform: scaleY(0.4); }
  50% { transform: scaleY(1); }
}

/* אינטראקציות קול */
.preview-timer {
  font-size: 16px;
  font-weight: 600;
  color: #202c33;
  font-family: monospace;
  min-width: 48px;
  text-align: center;
  user-select: none;
}

.audio-preview-row {
  display: flex;
  align-items: center;
  gap: 10px;
  width: 100%;
  background: #fcf5ed;
  padding: 8px 10px;
  border-radius: 20px;
  border: 1px solid #f3e3fa;
  margin-bottom: 8px;
}

.send-btn, .discard-btn {
  background: #7c43bd;
  color: #fff;
  border: none;
  border-radius: 18px;
  padding: 5px 18px;
  margin-right: 6px;
  font-size: 15px;
  cursor: pointer;
  transition: background 0.16s;
  min-width: 60px;
}
.send-btn:hover { background: #5d2997; }
.discard-btn { background: #e53935; }
.discard-btn:hover { background: #ad1c1a; }

.preview-btn.trash {
  color: #d93025;
  font-size: 22px;
  cursor: pointer;
  background: none;
  border: none;
  padding: 0;
  margin-left: 10px;
  flex-shrink: 0;
  transition: color 0.2s ease;
}
.preview-btn.trash:hover { color: #a52714; }

.recordBtn {
  order: 4;
  width: 36px;
  height: 36px;
  background: #f6f1fb;
  border-radius: 50%;
  border: none;
  font-size: 18px;
  color: #7c43bd;
  cursor: pointer;
  transition: background 0.17s;
  display: flex;
  align-items: center;
  justify-content: center;
  margin: 0;
  flex-shrink: 0;
}
.recordBtn.recording {
  background: #d93025;
  color: white;
  box-shadow: 0 0 10px #d93025aa;
}
.recordBtn:hover { background: #ede7f6; }

.sendButtonFlat {
  order: -1;
  width: 36px;
  height: 36px;
  background: none;
  border: none;
  outline: none;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  padding: 0;
  margin: 0 8px 0 0;
  border-radius: 50%;
  transition: background 0.14s;
  color: #7c43bd;
  font-size: 22px;
  font-weight: bold;
  flex-shrink: 0;
}
.sendButtonFlat:disabled {
  opacity: 0.33;
  cursor: not-allowed;
}
.sendButtonFlat:hover:enabled,
.sendButtonFlat:focus:enabled {
  background: #f4f7fa;
}

.attachBtn {
  order: 3;
  width: 36px;
  height: 36px;
  background: #f6f1fb;
  border-radius: 50%;
  border: none;
  font-size: 18px;
  color: #7c43bd;
  cursor: pointer;
  transition: background 0.17s;
  display: flex;
  align-items: center;
  justify-content: center;
  margin: 0;
  flex-shrink: 0;
}
.attachBtn:hover { background: #ede7f6; }

.fileInput { display: none; }

.error-alert {
  width: 100%;
  text-align: center;
  color: #e53935;
  background: #fff1f0;
  border: 1px solid #ffe2e2;
  border-radius: 12px;
  padding: 7px 0;
  margin-bottom: 6px;
  font-size: 14px;
  font-weight: 600;
}

.message img {
  margin-top: 3px;
  margin-bottom: 3px;
  border-radius: 12px;
  box-shadow: 0 2px 8px #0001;
  max-width: 180px;
  max-height: 240px;
}

.message audio {
  margin-top: 6px;
  outline: none;
  width: 100%;
  max-width: 220px;
}

/* עיצוב נגן אודיו בסגנון וואטסאפ */
.custom-audio-player {
  display: flex;
  align-items: center;
  background: #e5e5e5;
  border-radius: 20px;
  padding: 4px 10px;
  max-width: 260px;
  gap: 6px;
  user-select: none;
}
.custom-audio-player .avatar-wrapper { position: relative; }
.custom-audio-player .avatar-wrapper img {
  width: 32px;
  height: 32px;
  border-radius: 50%;
}
.custom-audio-player .mic-icon {
  position: absolute;
  bottom: 0;
  right: 0;
  background: #25d366;
  border-radius: 50%;
  width: 12px;
  height: 12px;
  display: flex;
  justify-content: center;
  align-items: center;
  color: white;
  font-size: 10px;
  border: 1.5px solid white;
  box-sizing: content-box;
  user-select: none;
}
.custom-audio-player button.play-pause {
  border-radius: 50%;
  border: none;
  background-color: #888;
  color: white;
  width: 28px;
  height: 28px;
  font-size: 16px;
  cursor: pointer;
  display: flex;
  justify-content: center;
  align-items: center;
  user-select: none;
  transition: background-color 0.2s;
}
.custom-audio-player button.play-pause.playing {
  background-color: #25d366;
}
.custom-audio-player .progress-dots {
  display: flex;
  gap: 3px;
  flex-grow: 1;
}
.custom-audio-player .progress-dots .dot {
  width: 5px;
  height: 5px;
  border-radius: 50%;
  background-color: #ccc;
  opacity: 0.5;
  transition: background-color 0.2s, opacity 0.2s;
}
.custom-audio-player .progress-dots .dot.active {
  background-color: #25d366;
  opacity: 1;
}
.custom-audio-player .time-display {
  font-size: 11px;
  color: #555;
  min-width: 40px;
  text-align: right;
  user-select: none;
}

/* רספונסיביות קטנות */
@media (max-width: 480px) {
  .custom-audio-player {
    max-width: 200px;
    padding: 3px 8px;
    gap: 5px;
  }
  .custom-audio-player .avatar-wrapper img { width: 24px; height: 24px; }
  .custom-audio-player .mic-icon {
    width: 10px; height: 10px; font-size: 8px; border: 1px solid white;
  }
  .custom-audio-player button.play-pause {
    width: 24px; height: 24px; font-size: 14px;
  }
  .custom-audio-player .progress-dots .dot {
    width: 4px; height: 4px;
  }
  .custom-audio-player .time-display {
    font-size: 10px; min-width: 30px;
  }
}

/* רספונסיביות כללית */
@media (max-width: 768px) {
  .message { max-width: 90%; padding: 8px 12px 6px 10px; font-size: 14px; }
  .chat-container.client .message.mine { margin-left: 16px; margin-right: 0; }
  .chat-container.client .message.theirs { margin-right: 16px; margin-left: 0; }
  .inputBar { padding: 8px 10px 8px 8px; min-height: 56px; gap: 6px; }
  .inputBar textarea, .inputField {
    font-size: 14px; padding: 10px 12px; border-radius: 22px;
  }
  .sendButtonFlat, .attachBtn, .recordBtn { width: 32px; height: 32px; font-size: 20px; }
}

@media (max-width: 400px) {
  .message { max-width: 100%; padding: 6px 10px 5px 8px; font-size: 13px; }
  .chat-container.client .message.mine { margin-left: 8px; margin-right: 0; }
  .chat-container.client .message.theirs { margin-right: 8px; margin-left: 0; }
  .inputBar textarea, .inputField {
    font-size: 13px;
    padding: 8px 10px;
  }
  .sendButtonFlat, .attachBtn, .recordBtn {
    width: 28px; height: 28px; font-size: 18px;
  }
}
